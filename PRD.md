# Muffin Pan Recipes PRD

> **Note:** This PRD captures intent and constraints. Detailed specifications (EARS requirements, schemas, API endpoints) are generated by Kiro and live in `.kiro/specs/ai-creative-team/`. Some legacy schema details remain in this document from before workflow refinement.

## 1) Overview

Muffin Pan Recipes is an AI-driven content platform disguised as a recipe website. The recipes are real and useful, but the actual product is **AI personalities working as a creative team**. The audience experiences a living creative studio that happens to produce muffin tin meals - with character arcs, creative tension, and emotional continuity across "seasons" of content.

The site prioritizes the "No-Fluff" philosophy: no bloggy preambles, no life stories before recipes. Just beautiful food photography, precise instructions, and behind-the-scenes drama from the AI editorial team.

## 2) Goals

- Create a multi-agent AI creative team with distinct personalities, functions, and evolving relationships.
- Produce high-quality muffin tin recipes with professional-grade AI photography.
- Surface the "creative tension" between AI personalities as entertainment content.
- Implement a meta-learning layer where Erik + AI partner periodically tune the worker agents.
- Build a sustainable content engine that improves over time through agent learning.

## 3) Non-Goals

- Becoming a generic recipe aggregator.
- User-generated content (Phase 1).
- Video content (deferred to Phase 6).
- Monetization via ads (anti-pattern for "No-Fluff" philosophy).

## 3.5) Constraints

### Security
- **Authentication:** Google OAuth for admin access (Erik's Google account).
- **Authorization:** Admin-only access to recipe review, approval, and pipeline management. Public site is read-only.
- **No public write access:** No user accounts, no comments, no submissions (Phase 1).

### Performance
- **Page load:** < 3 seconds on mobile (static site, should be fast).
- **Recipe generation:** No strict time limit (batch process, not real-time).

### Integration Context
- **Existing infrastructure:** Discord webhooks for notifications (see `EXTERNAL_RESOURCES.yaml`).
- **Hosting:** Vercel (auto-deploy from GitHub).
- **AI models:** Ollama for local LLM (Baker, Copywriter), future cloud models for others.

## 4) Target Users

- Home cooks who hate recipe blog preambles and want "Jump to Recipe" immediately.
- Meal preppers who appreciate the modular, portion-controlled nature of muffin tin cooking.
- AI/tech enthusiasts interested in watching AI personalities collaborate and conflict.
- Pinterest/Instagram users drawn to high-end food photography.

## 5) Problem Statement

Recipe websites are cluttered with ads, life stories, and SEO fluff. Users want fast, reliable recipes. Meanwhile, AI-generated content is often soulless and interchangeable. Muffin Pan Recipes solves both: clean, efficient recipes produced by AI personalities with depth, conflict, and growth arcs.

## 6) Core Concept: The Living Creative Studio

### Layer 1: The Creative Team (Worker Agents)

Seven distinct AI personalities with functional roles:

| Role | Function | Personality | Model Suggestion |
|------|----------|-------------|------------------|
| **Baker** | Recipe development, ingredients, instructions | 50s traditionalist, skeptical of trendy ingredients | Ollama (llama3.2) |
| **Creative Director** | Final arbiter of quality | Sophisticated, decisive, "Grumpy Architect" | DeepSeek-R1 |
| **Art Director** | Commands the photographer, selects visuals | Obsessed with lighting and texture | GPT-4o |
| **Editorial Copywriter** | Recipe titles, descriptions, voice | Professional, witty, precise | Claude |
| **Site Architect** | HTML/Tailwind, SEO, mobile-first | Technical, fast, "Speed is a feature" | Qwen |
| **Social Dispatcher** | Pinterest, Instagram, TikTok presence | Outgoing, trend-aware, engaging | Gemini Flash |
| **Screenwriter** | Captures creative tension as narrative | Observational, witty, documentarian | Claude |

### Layer 2: The Writers Room (Story Planners)

A meta-layer of AI "story writers" above the creative team:

- Plan character arcs over "seasons" of content (batches of 10-20 recipes)
- Inject life events that affect work quality and relationships
- Create tension and resolution between team members
- Ensure emotional continuity across months of content

Example arc: "Over the next 20 recipes, the Copywriter gradually finds their voice while the Photographer has a creative block around recipe 15, then a breakthrough."

### Layer 3: Meta-Learning (Erik + AI Partner)

Weekly or monthly review sessions:

- Evaluate if memory formats are helping agents retain patterns
- Introduce "curriculum" (study food photography from a specific era)
- Tune control parameters based on output quality
- Track what's working in the agent learning environment

## 7) Data Model (MVP)

### Recipe

```yaml
id: string
slug: string
title: string
description: string
why_muffin_pans: string
category: breakfast | lunch | dinner | snack | dessert
yield: { count: int, pan_type: standard | jumbo | mini }
prep_time_minutes: int
cook_time_minutes: int
ingredients: [{ amount: string, metric: string, imperial: string, item: string }]
instructions: [{ step: int, action: string }]
tips: [string]
image_path: string
created_at: datetime
editorial_notes: { director: string, art_director: string }  # NEW
```

### AgentPersona

```yaml
id: string
name: string
role: creative_director | art_director | copywriter | site_architect | social_dispatcher | screenwriter
model: string
personality_traits: [string]
backstory: string
current_mood: string  # Updated by Writers Room
active_arc: string    # Current character arc
memory_file: path     # Persistent memory for this agent
```

### CreativeTension (Screenwriter Output)

```yaml
recipe_id: string
date: datetime
participants: [agent_id]
tension_type: disagreement | collaboration | breakthrough | conflict
dialogue_log: string  # The "behind the scenes" content
resolution: string
```

### Season

```yaml
season_id: string
start_date: date
end_date: date
theme: string
planned_arcs: [{ agent_id: string, arc_description: string }]
life_events: [{ agent_id: string, event: string, impact: string }]
```

## 8) Functional Requirements

### Recipe Pipeline

**See full workflow diagram:** [Documents/WORKFLOW_DIAGRAM.md](Documents/WORKFLOW_DIAGRAM.md)

**Summary of 7-Stage Pipeline:**

| Stage | Agent | Function |
|-------|-------|----------|
| 1. Recipe Development | Baker (Margaret) | Generate ingredients, instructions, chef notes |
| 2. Photography | Art Director (Julian) | Generate/select hero image |
| 3. Copywriting | Copywriter (Marcus) | Write literary description |
| 4. Creative Review | Creative Director (Steph) | Quality gate - approve or request revisions |
| 5. Human Review | Erik | Final approval via admin dashboard |
| 6. Deployment | Site Architect (Devon) | Generate HTML, deploy to Vercel |
| 7. Social Distribution | Social Dispatcher | Pinterest/Instagram posts |

**Key Decision Points:**
- Stage 4: Creative Director can reject → triggers revision loop (max 3 cycles)
- Stage 5: Human can reject → recipe archived with notes

**Data Flow:**
```
Concept → [Baker] → [Art Director] → [Copywriter] → [Creative Director]
                                                            ↓
                                          [Human Review] ← APPROVE
                                                            ↓
                                          [Site Architect] → Published
                                                            ↓
                                          [Social Dispatcher] → Pinterest/Instagram
```

### Agent Memory System

- Each agent has a persistent memory file.
- Memory stores: past decisions, feedback received, creative preferences.
- Memory is consulted before each task.
- Erik + AI partner can update memory during meta-learning sessions.

### Writers Room System

- Define "seasons" of content (10-20 recipes).
- Plan character arcs for each agent.
- Inject life events mid-season.
- Track arc progress and adjust based on output quality.

### Editorial Dashboard (Admin)

- View current recipe pipeline status.
- Monitor agent "debates" and "grumpy reviews."
- Trigger new batch generation.
- Preview recipes before deployment.
- View agent memory and current mood/arc.

## 9) Non-Functional Requirements

- No hardcoded absolute paths; use relative paths or PROJECT_ROOT.
- No secrets in code; use .env and os.getenv() or Doppler.
- Safe file operations and validation before completion.
- Modular pipeline so each agent step is independently testable.

## 10) UX and UI Requirements

### Public Site (muffinpanrecipes.com)

- "No-Fluff" design: Jump to Recipe above the fold.
- High-key, white marble aesthetic matching IMAGE_STYLE_GUIDE.md.
- Mobile-first, fast load times.
- "Behind the Scenes" section showing Screenwriter's dialogue logs (optional).
- Editorial notes from Creative Director / Art Director on each recipe.

### Admin Dashboard (Web-Based)

- Recipe pipeline kanban (Draft → Photography → Review → Deployed).
- Agent status panel (current mood, active arc).
- "Creative Tension" feed showing recent debates.
- One-click batch generation trigger.
- **Recipe Review Interface** - Dedicated URLs for reviewing pending recipes.
- **Discord Notifications** - Webhook alerts when recipes are ready for review.

### Authentication

- **Google OAuth** - Login with Google account (Erik's primary auth method).
- Protected admin routes requiring authentication.
- No public access to admin/review features.
- Session management with secure cookies.

## 10.5) Infrastructure Requirements

**This section defines the "boring plumbing" that makes the creative vision actually work. Without this infrastructure, generated recipes have nowhere to go.**

### Recipe Storage & Lifecycle

**Requirement:** Every generated recipe MUST be persisted to storage immediately upon creation. Recipes cannot exist only in memory.

**Recipe States:**
```
pending → approved → published
       ↘ rejected (archived)
```

**Storage Structure:**
```
data/
├── recipes/
│   ├── pending/          # Awaiting review
│   │   └── {recipe_id}.json
│   ├── approved/         # Ready to publish
│   │   └── {recipe_id}.json
│   ├── published/        # Live on site
│   │   └── {recipe_id}.json
│   └── rejected/         # Archived failures
│       └── {recipe_id}.json
└── stories/              # Behind-the-scenes content
    └── {recipe_id}_story.json
```

**Recipe JSON Schema (stored):**
```yaml
recipe_id: string (uuid)
status: pending | approved | published | rejected
created_at: datetime
updated_at: datetime
published_at: datetime (nullable)

# Core recipe data
title: string
slug: string (url-safe)
description: string (Marcus's literary description)
category: breakfast | lunch | dinner | snack | dessert
difficulty: easy | medium | hard

# Timing & yield
prep_time_minutes: int
cook_time_minutes: int
servings: int

# Content
ingredients: [{ amount: string, item: string, notes: string }]
instructions: [string]
chef_notes: string (Margaret's notes)

# Media
image_path: string (nullable until image generated)
image_status: pending | generated | approved

# Metadata
generated_by: { baker: string, copywriter: string }
review_notes: string (nullable, from Erik)
```

### Publishing Pipeline

**Requirement:** Approved recipes MUST be convertible to static HTML and deployable to Vercel without manual intervention.

**Pipeline Steps:**
1. Recipe reaches `approved` status
2. System generates static HTML from template
3. HTML placed in `src/recipes/{slug}/index.html`
4. `recipes.json` updated with new entry
5. `sitemap.xml` regenerated
6. Git commit + push triggers Vercel deploy
7. Recipe status updated to `published`

**Rollback:** If deployment fails, recipe remains `approved` (not `published`) and admin is notified.

### Email System

**Requirement:** The site MUST have a functioning email address for newsletter signups and contact.

**Components:**
- Primary email: `hello@muffinpanrecipes.com` (or similar)
- Newsletter signup storage (email + signup date)
- Optional: Integration with email service (Buttondown, ConvertKit, etc.)

**Newsletter Data Schema:**
```yaml
email: string
subscribed_at: datetime
source: homepage | recipe_page | footer
status: active | unsubscribed
```

### Notification System

**Requirement:** Key events MUST trigger notifications to keep Erik in the loop without requiring constant monitoring.

**Events that trigger Discord notifications:**
- Recipe generated and pending review
- Recipe approved (ready for publish)
- Recipe published (live on site)
- Pipeline errors or failures
- Weekly digest of pending reviews

**Webhook:** Discord channel configured for Muffin Pan Recipes alerts.

### Admin API Endpoints

**Requirement:** All admin operations MUST be accessible via authenticated API endpoints.

**Core Endpoints:**
```
GET  /admin/recipes                # List all recipes by status
GET  /admin/recipes/{id}           # Get single recipe with story
POST /admin/recipes/{id}/approve   # Move to approved
POST /admin/recipes/{id}/reject    # Move to rejected with notes
POST /admin/recipes/{id}/publish   # Trigger publish pipeline
POST /admin/generate               # Trigger new recipe generation
GET  /admin/stats                  # Pipeline statistics
```

### Backup & Recovery

**Requirement:** Recipe data MUST be recoverable in case of data loss.

- All recipe JSON files tracked in git
- Stories tracked in git
- Published recipes exist as both JSON and HTML (redundant)
- Subscriber list backed up separately (contains PII, not in public git)

## 11) Success Metrics

| Metric | Target |
|--------|--------|
| Recipes published per month | 8-12 |
| Creative Director rejection rate | < 30% |
| Agent memory utilization | Consulted on 100% of tasks |
| Pinterest engagement (saves) | Track baseline, improve 10%/month |
| "Behind the Scenes" page views | > 20% of recipe page views |
| Meta-learning sessions | 2-4 per month |

## 12) MVP Scope (Phase 4-5)

- [ ] Implement agent memory system (persistent files per agent).
- [ ] Build "Grumpy Review" protocol for Creative Director.
- [ ] Add Screenwriter agent to capture tension logs.
- [ ] Store editorial_notes on each recipe.
- [ ] Build local admin dashboard (FastAPI + Tailwind).
- [ ] Define first "season" with Writers Room arcs.

## 13) Post-MVP (Phase 6+)

- Video content ("Cinematic Build" 15-second clips).
- Social Dispatcher automation (Pinterest/Instagram posting).
- User-submitted recipes (with AI quality check).
- Merch store ("I didn't use the oven" t-shirts).
- The "Personality Responder" for comment engagement.

## 14) Technical Stack

| Component | Technology |
|-----------|------------|
| Frontend | Static HTML + Tailwind CSS |
| Hosting | Vercel (auto-deploy from GitHub) |
| Image Generation | Stability AI via RunPod |
| AI Orchestration | AI Router (local-first) + Agent Hub |
| Admin Dashboard | FastAPI + Tailwind |
| Authentication | Google OAuth 2.0 |
| Notifications | Discord Webhooks |
| Database | JSON files (MVP) → SQLite (later) |
| Agent Memory | Markdown files with structured YAML |

## 15) Constraints and Governance

- Follow project governance and review protocol.
- Use validation commands before completion.
- All recipes must pass Creative Director review before deployment.
- No deployment without image selection by Art Director.
- Character arcs defined by Writers Room, not ad-hoc.

## 16) Risks

| Risk | Likelihood | Mitigation |
|------|------------|------------|
| Agent personalities feel shallow | Medium | Deep backstories, persistent memory, arc planning |
| Creative tension feels artificial | Medium | Screenwriter captures real disagreements, not scripted |
| Image generation costs escalate | Low | Batch processing, RunPod spot instances |
| Recipe quality inconsistent | Medium | Creative Director gate, template enforcement |
| Meta-learning sessions get skipped | Medium | Calendar reminders, measurable outcomes |

## 17) Open Items

- Confirm memory format (Markdown + YAML vs SQLite).
- Define first season theme and arcs.
- Decide if "Behind the Scenes" is public or Patreon-gated.
- Determine Social Dispatcher posting frequency.

## 18) The Vision

> "My goal is to make muffinpanrecipes super entertaining and have the AI personalities - that's the real content - but we're doing it through a recipe website."
>
> — Erik, January 4, 2026

This isn't an AI tool. It's a **living creative studio** that happens to produce recipes. A reality show where the cast improves over time and the audience watches it happen through the lens of muffin pan meals.

Procedurally generated serialized content with emotional coherence.

---

*PRD Version: 1.0*
*Created: January 19, 2026*
*Author: Claude Code (Opus 4.5) - Super Manager*
